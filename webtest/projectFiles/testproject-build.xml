<project name='acegitest' default='test'>

	<taskdef resource='net/sf/antcontrib/antlib.xml'>
		<classpath>
			<pathelement location='lib/ant-contrib-1.0b3.jar'/>
		</classpath>
	</taskdef>

	<condition property='grails' value='grails.bat'>
		<os family='windows'/>
	</condition>
	<property name='grails' value='grails' />

	<target name='clean'>
		<exec executable='${grails}' failonerror='true'><arg value='clean'/></exec>
	</target>

	<target name='war'>
		<exec executable='${grails}' failonerror='true'><arg value='war'/></exec>
	</target>

	<target name='webtest' description='Run webtests' depends='clean'>

		<trycatch>
			<try>
				<copy file='grails-app/conf/SecurityConfig-annotation_groovy' tofile='grails-app/conf/SecurityConfig.groovy' overwrite='true' />
				<exec executable='${grails}' failonerror='true'>
					<arg value='run-webtest'/>
					<arg value='AnnotationSuite'/>
				</exec>
			</try>
			<catch />
		</trycatch>

		<trycatch>
			<try>
				<copy file='grails-app/conf/SecurityConfig-requestmap_groovy' tofile='grails-app/conf/SecurityConfig.groovy' overwrite='true' />
				<exec executable='${grails}' failonerror='true'>
					<arg value='run-webtest'/>
					<arg value='RequestmapSuite'/>
				</exec>
			</try>
			<catch />
		</trycatch>

		<trycatch>
			<try>
				<copy file='grails-app/conf/SecurityConfig-static_groovy' tofile='grails-app/conf/SecurityConfig.groovy' overwrite='true' />
				<exec executable='${grails}' failonerror='true'>
					<arg value='run-webtest'/>
					<arg value='StaticSuite'/>
				</exec>
			</try>
			<catch />
		</trycatch>

	</target>

</project>

